<h1 style="position: relative;" class="text-center">
    <button mat-button style="position: absolute; left: 0;"
    [routerLink]="['..']">
        <mat-icon class="material-symbols-outlined">
            chevron_left
        </mat-icon>
        Back
    </button>
    Analysis Project
</h1>

<div style="position: relative;" class="app-mb-1 app-ml-1">
    <button mat-flat-button class="bg-secondary" style="position: absolute; left: 0;"
    (click)="editProject()">
        <mat-icon class="material-symbols-outlined">
            edit
        </mat-icon>
        Edit Project Name/Description
    </button>

    <h2 class="text-center">
        {{name}}
    </h2>

</div>

<div class="text-center app-mb-2" style="color: #666; font-style: italic;">
    {{description}}
</div>


@if (threats && threats.length > 0) {
    <app-project-stats-view></app-project-stats-view>
} @else {
    <div class="app-info app-mlr-1">
        <mat-icon class="material-symbols-outlined">info</mat-icon>
        <div class="info-content">
            <h3>Get Started with Your Analysis</h3>
            <p>To begin your climate resilience analysis, you'll need to:</p>
            <ol>
                <li>Add climate threats relevant to your project</li>
                <li>Add equipment and assets to analyze</li>
                <li>Define resilience strategies to evaluate</li>
            </ol>
        </div>
    </div>
}

<h3 class="text-center">
    Climate Threats
</h3>

<div class="app-mb-1 app-ml-1">
    <button mat-flat-button class="bg-secondary"
    (click)="addThreat()">
        <mat-icon class="material-symbols-outlined">
            add
        </mat-icon>
        Add a Climate Threat
    </button>
</div>

@if (threats && threats.length > 0) {
<mat-accordion>
    @for (threat of threats; track threat.id) {
    <mat-expansion-panel>

        <mat-expansion-panel-header>

            <mat-panel-title class="app-flex-gap">
                <mat-icon class="material-symbols-outlined fg-secondary">
                    {{getThreatIcon(threat.threatType)}}
                </mat-icon>
                <span class="text-italic">
                    {{getThreatName(threat.threatType)}} -
                </span>
                {{threat.name}}
            </mat-panel-title>

            <mat-panel-description>
                {{threat.description}}
            </mat-panel-description>

        </mat-expansion-panel-header>

        <app-project-threat-view
        [projectThreat]="threat"
        [dataChanged$]="dataChanged$">
        </app-project-threat-view>

    </mat-expansion-panel>
    }
</mat-accordion>
} @else {
    <div class="text-center app-mt-2 text-italic" style="color: #888;">
        No climate threats added yet. Click "Add a Climate Threat" above to get started.
    </div>
}
